logit <- function(x) return(log(x/(1-x)))
invlogit <- function(x) return(exp(x)/(1+exp(x)))

## South Africa ANC data
sa.anc <- data.frame(year=1990:2008,
                     prevalence=c(0.0076, 0.0135, 0.0242, 0.0425, 0.0757, 0.1044, 0.1417, 0.1700, 0.2280, 0.2240, 0.2450, 0.2480, 0.2650, 0.2790, 0.2950, 0.3020, 0.2910, 0.2940, 0.2930),
                     lowerCI=c(0.0057, 0.0111, 0.0208, 0.038, 0.0701, 0.0986, 0.1345, NA, 0.212, 0.213, 0.234, 0.236, 0.255, 0.268, 0.285, 0.291, 0.283, 0.285, 0.285),
                     upperCI=c(0.0096, 0.0159, 0.0276, 0.0471, 0.0812, 0.1102, 0.1489, NA, 0.243, 0.236, 0.256, 0.261, 0.276, 0.289, 0.305, 0.312, 0.299, 0.301, 0.301),
                     se=c(0.000994916241003075, 0.00122451229661917, 0.00173472575354382, 0.00232147122900718, 0.00283168468593183, 0.00295923805016299, 0.00367353688985752, NA, 0.00790830858233214, 0.00586745475463353, 0.0056123480261712, 0.00637766821155817, 0.00535724129770887, 0.00535724129770886, 0.00510213456924655, 0.00535724129770886, 0.00408170765539722, 0.00408170765539724, 0.00408170765539724),
                     var=c(0.000994916241003075, 0.00122451229661917, 0.00173472575354382, 0.00232147122900718, 0.00283168468593183, 0.00295923805016299, 0.00367353688985752, NA, 0.00790830858233214, 0.00586745475463353, 0.0056123480261712, 0.00637766821155817, 0.00535724129770887, 0.00535724129770886, 0.00510213456924655, 0.00535724129770886, 0.00408170765539722, 0.00408170765539724, 0.00408170765539724)^2,
                     logit.p=c(-4.87197800452536, -4.29147364001829, -3.6969050142191, -3.11482164512443, -2.50225853382733, -2.14926420927606, -1.80124154202754, -1.58562726374038, -1.21963892107034, -1.24250646832818, -1.1254595387043, -1.10930757778486, -1.02014067322661, -0.949427355463584, -0.871222446472449, -0.837792085387503, -0.890532259360635, -0.87603547015456, -0.880858056879506),
                     logit.var=c(0.0174009253910503, 0.00845404558424002, 0.00539646410336099, 0.00325440190822391, 0.00163784243513377, 0.00100168377198185, 0.000912327750856206, NA, 0.00201865880133789, 0.00113940998103536, 0.000920583350986115, 0.00116945846315392, 0.00075651229394441, 0.000709256753990143, 0.00060184069734196, 0.000645888697665774, 0.000391386051238339, 0.000386704947987026, 0.000388248443801718),
                     logit.se=c(0.131912567221817, 0.0919458839983608, 0.0734606296145152, 0.0570473654801334, 0.040470266062058, 0.0316493881770541, 0.0302047637113123, 0.04, 0.0449294869917061, 0.0337551474746498, 0.0303411165085617, 0.0341973458495527, 0.0275047685673668, 0.0266318747742276, 0.0245324417321627, 0.0254143403940723, 0.0197834792500798, 0.0196648149746451, 0.0197040210059195))
                     
sa.anc$timestep <- 1:19
sa.anc$logit.var <- sa.anc$logit.se^2


##########
### HSRC 2002: 15-49 females 0.177, males 0.128 (no CIs provided), total 15.6 (0.139-0.176)
### HSRC 2005: 15-49 females 0.202 (0.183-0.222), males 0.117 (0.100-0.136), total 0.162 (0.149-0.177)
### HSRC 2008: 15-49 total 0.169 (0.155, 0.184)

sa.hsrc.male <- data.frame(year = c(2002, 2005, 2008),
                           prevalence = c(0.128, 0.117, 0.116),
                           logit.p = logit(c(0.128, 0.117, 0.116)),
                           logit.var = c(((logit(0.152) - logit(0.108))/(2*qnorm(.975)))^2,
                             ((logit(0.136) - logit(0.1))/(2*qnorm(.975)))^2,
                             ((logit(0.137) - logit(0.098))/(2*qnorm(.975)))^2))

sa.hsrc.female <- data.frame(year = c(2002, 2005, 2008),
                             prevalence = c(0.177, 0.202, 0.213),
                             logit.p = logit(c(0.177, 0.202, 0.213)),
                             logit.var = c(((logit(0.205) - logit(0.152))/(2*qnorm(.975)))^2,
                               ((logit(0.222) - logit(0.183))/(2*qnorm(.975)))^2,
                               ((logit(0.232) - logit(0.195))/(2*qnorm(.975)))^2))

sa.hsrc.male$timestep <- sa.hsrc.male$year - 1989
sa.hsrc.female$timestep <- sa.hsrc.female$year - 1989
